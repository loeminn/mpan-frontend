{"version":3,"sources":["webpack:///./src/views/shareContent/ShareContent.vue","webpack:///./src/views/shareContent/childComps/ShareValidation.vue","webpack:///./src/utils/CookieUtil.js","webpack:///./src/views/shareContent/childComps/ShareValidation.vue?3272","webpack:///./src/views/shareContent/childComps/ShareNoExists.vue","webpack:///./src/views/shareContent/childComps/ShareNoExists.vue?1f3d","webpack:///./src/views/shareContent/childComps/ShareContentHome.vue","webpack:///./src/views/shareContent/childComps/ShareContentHeader.vue","webpack:///./src/views/shareContent/childComps/ShareContentHeader.vue?2bff","webpack:///./src/views/shareContent/childComps/ShareContentHome.vue?a018","webpack:///./src/views/shareContent/ShareContent.vue?1ad2","webpack:///./src/views/shareContent/childComps/ShareValidation.vue?d599","webpack:///./src/views/shareContent/childComps/ShareValidation.vue?c6ee","webpack:///./src/views/shareContent/ShareContent.vue?17de","webpack:///./src/views/shareContent/childComps/ShareContentHome.vue?1eb0","webpack:///./src/views/shareContent/childComps/ShareNoExists.vue?db05","webpack:///./src/views/shareContent/childComps/ShareContentHeader.vue?a156"],"names":["class","isLoading","noExists","shareInfo","isPublic","isVerify","share-info","changeVerifyStatus","src","showAvatar","userName","ref","model","form","rules","formRules","prop","accessCode","extractFiles","setCookie","key","value","expireMinutes","date","Date","setTime","getTime","document","cookie","toUTCString","getCookie","arrCookie","split","forEach","item","name","components","MForm","MFormItem","MButton","MInput","props","Object","data","required","message","computed","this","userAvatar","defaultAvatar","methods","formName","$refs","validate","valid","close","$message","loading","id","then","res","shareToken","sessionStorage","setItem","$emit","catch","error","msg","render","__scopeId","$router","back","push","openSaveModal","getDownloadUrl","root-path","$route","path","title","file-length","fileList","length","has-upload","file-list","selectList","body","empty-text","footer","type","saveModal","save","aria-hidden","xlink:href","shareIcon","icon","saveClick","downloadClick","createTime","expiryTime","FileListEmpty","DirList","Modal","LoadingMask","FileListTable","FileListMain","ShareContentHeader","loadFileList","query","saveDirList","success","token","localStorage","getItem","open","$modal","confirm","content","okText","closeIcon","lossFocusClose","onOk","location","href","info","s","find","f","isDir","warning","download","url","frame","createElement","setAttribute","appendChild","setTimeout","remove","watch","handler","startsWith","mounted","ShareContentHome","ShareNoExists","ShareValidation","flag","isPublicGetToken","Promise","reject","checkExistingToken","resolve","removeItem","shareInitialization","params","shortLink","tokenCheckFlag","code"],"mappings":"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","file":"js/chunk-646c91dc.7b6c7bb7.js","sourcesContent":["<template>\r\n  <div class=\"share-content\">\r\n    <loading-mask v-if=\"isLoading\"/>\r\n    <share-no-exists v-else-if=\"noExists\"/>\r\n    <share-validation v-else-if=\"shareInfo.isPublic===0&&!isVerify\"\r\n                      :share-info=\"shareInfo\"\r\n                      @changeVerifyStatus=\"changeVerifyStatus\"/>\r\n    <share-content-home :share-info=\"shareInfo\" v-else/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ShareValidation from \"@/views/shareContent/childComps/ShareValidation\";\r\nimport {checkShareToken, getShareInfo, verifyAccessCode} from \"@/api/share\";\r\nimport LoadingMask from \"@/components/loadingMask/LoadingMask\";\r\nimport ShareNoExists from \"@/views/shareContent/childComps/ShareNoExists\";\r\nimport {getCookie, setCookie} from \"@/utils/CookieUtil\";\r\nimport ShareContentHome from \"@/views/shareContent/childComps/ShareContentHome\";\r\n\r\nexport default {\r\n  name: \"ShareContent\",\r\n  components: {ShareContentHome, ShareNoExists, LoadingMask, ShareValidation},\r\n  data() {\r\n    return {\r\n      shareInfo: {},\r\n      isLoading: true,\r\n      noExists: false,\r\n      isVerify: false\r\n    }\r\n  },\r\n  methods: {\r\n    changeVerifyStatus(flag) {\r\n      this.isVerify = flag\r\n    },\r\n    isPublicGetToken() {\r\n      return verifyAccessCode(this.shareInfo.id, null)\r\n          .then(res => {\r\n            setCookie(this.shareInfo.id, res.data.shareToken, 120)\r\n            sessionStorage.setItem('shareToken', res.data.shareToken)\r\n          }).catch(() => {\r\n            Promise.reject()\r\n          })\r\n    },\r\n    checkExistingToken() {\r\n      return checkShareToken(this.shareInfo.id)\r\n          .then(() => {\r\n            this.isVerify = true\r\n            this.isLoading = false\r\n            Promise.resolve(true)\r\n          })\r\n          .catch(() => {\r\n            setCookie(this.shareInfo.id, '', new Date(1))\r\n            sessionStorage.removeItem('shareToken')\r\n            Promise.resolve(false)\r\n          })\r\n    },\r\n    async shareInitialization() {\r\n      await getShareInfo(this.$route.params.shortLink)\r\n          .then(async res => {\r\n            this.shareInfo = res.data\r\n            const shareToken = getCookie(res.data.id)\r\n            if (shareToken) {\r\n              sessionStorage.setItem('shareToken', shareToken)\r\n              const tokenCheckFlag = await this.checkExistingToken()\r\n              if (tokenCheckFlag) return\r\n            }\r\n            if (this.shareInfo.isPublic === 1) {\r\n              await this.isPublicGetToken()\r\n            }\r\n          })\r\n          .catch(res => {\r\n            if (res.code === -401) {\r\n              this.noExists = true\r\n            } else {\r\n              this.$message.error(res.msg)\r\n            }\r\n          })\r\n      this.isLoading = false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.shareInitialization()\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.share-content {\r\n  height: calc(100vh - 56px);\r\n}\r\n</style>","<template>\r\n  <div class=\"share-validation\">\r\n    <div class=\"validation-box\">\r\n      <div class=\"share-info\">\r\n        <div class=\"avatar\">\r\n          <img :src=\"showAvatar\"/>\r\n        </div>\r\n        <div>\r\n          <div class=\"user-name\">{{ shareInfo.userName }}</div>\r\n          <div class=\"share-text\">分享的文件</div>\r\n        </div>\r\n      </div>\r\n      <div class=\"verify-form\">\r\n        <div class=\"verify-form-label\">请输入提取码：</div>\r\n        <div class=\"verify-form-body\">\r\n          <m-form ref=\"verifyForm\" :model=\"form\" :rules=\"formRules\">\r\n            <m-form-item prop=\"accessCode\">\r\n              <m-input v-model=\"form.accessCode\"/>\r\n            </m-form-item>\r\n          </m-form>\r\n          <m-button @click=\"extractFiles('verifyForm')\">提取文件</m-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"cloud-bg\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getAvatar, iconType} from \"@/utils/FileIcon\";\r\nimport MInput from \"@/components/common/MInput\";\r\nimport MButton from \"@/components/common/MButton\";\r\nimport MFormItem from \"@/components/common/MFormItem\";\r\nimport MForm from \"@/components/common/MForm\";\r\nimport {getShareInfo, verifyAccessCode} from \"@/api/share\";\r\nimport {setCookie} from \"@/utils/CookieUtil\";\r\n\r\nexport default {\r\n  name: \"ShareValidation\",\r\n  components: {MForm, MFormItem, MButton, MInput},\r\n  props: {\r\n    shareInfo: Object\r\n  },\r\n  data() {\r\n    return {\r\n      form: {\r\n        accessCode: ''\r\n      },\r\n      formRules: {\r\n        accessCode: [\r\n          {required: true, message: '请输入提取码'}\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    showAvatar() {\r\n      if (this.shareInfo.userAvatar) {\r\n        return getAvatar(this.shareInfo.userAvatar)\r\n      } else {\r\n        return iconType.defaultAvatar;\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    extractFiles(formName) {\r\n      this.$refs[formName].validate(valid => {\r\n        if (valid) {\r\n          const close = this.$message.loading('正在提取', 'extractFiles');\r\n          verifyAccessCode(this.shareInfo.id, this.form.accessCode)\r\n              .then(res => {\r\n                close()\r\n                setCookie(this.shareInfo.id, res.data.shareToken, 120)\r\n                sessionStorage.setItem('shareToken', res.data.shareToken)\r\n                this.$emit('changeVerifyStatus', true)\r\n              })\r\n              .catch(res => {\r\n                this.$message.error(res.msg, 1500, 'extractFiles')\r\n              })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.verify-form-body .m-form-item .message {\r\n  margin-top: 10px;\r\n}\r\n\r\n.verify-form-body .m-text-input {\r\n  border: 1px solid #f2f2f2;;\r\n}\r\n</style>\r\n<style scoped>\r\n.share-text {\r\n  color: #E1F5FF;\r\n  font-size: 10px;\r\n}\r\n\r\n.cloud-bg {\r\n  position: absolute;\r\n  height: 400px;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-image: url(\"https://lm-icon.oss-cn-shenzhen.aliyuncs.com/mpan/background/footer-cloud.png\");\r\n  background-repeat: repeat-x;\r\n  background-position: 0 bottom;\r\n}\r\n\r\n.verify-form-body .m-form {\r\n  width: 100%;\r\n}\r\n\r\n.verify-form-body .m-button {\r\n  margin-left: 14px;\r\n  margin-bottom: 30px;\r\n  background-color: #09AAFF;\r\n}\r\n\r\n.verify-form-body {\r\n  display: flex;\r\n}\r\n\r\n.verify-form {\r\n  padding: 20px 32px 38px;\r\n}\r\n\r\n.verify-form-label {\r\n  font-weight: 700;\r\n  margin: 22px 0 16px;\r\n  color: #666;\r\n  font-size: 14px;\r\n}\r\n\r\n.user-name {\r\n  font-size: 16px;\r\n  font-weight: 900;\r\n  color: #fff;\r\n  height: 24px;\r\n  line-height: 24px;\r\n}\r\n\r\n.share-info {\r\n  height: 80px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0 32px;\r\n  background: url(\"https://lm-icon.oss-cn-shenzhen.aliyuncs.com/mpan/background/share-tit-bg.png\") no-repeat;\r\n}\r\n\r\n.avatar {\r\n  width: 44px;\r\n  height: 44px;\r\n  overflow: hidden;\r\n  border-radius: 50%;\r\n  box-shadow: 0 0 0 3px #9ADAF2;\r\n  background-color: #fff;\r\n  margin-right: 18px;\r\n}\r\n\r\n.avatar img {\r\n  width: 100%;\r\n}\r\n\r\n.share-validation {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: #eef2f6;\r\n}\r\n\r\n.validation-box {\r\n  width: 460px;\r\n  font-size: 14px;\r\n  position: relative;\r\n  background-color: #fff;\r\n  border-radius: 6px;\r\n  overflow: hidden;\r\n  box-shadow: 0 0 10px rgba(171, 198, 235, .3);\r\n  z-index: 9;\r\n  margin-bottom: 22px;\r\n}\r\n</style>","export function setCookie(key, value, expireMinutes) {\r\n    const date = new Date();\r\n    date.setTime(date.getTime() + (1000 * 60 * expireMinutes))\r\n    document.cookie = key + '=' + value + \";expires=\" + date.toUTCString()\r\n}\r\n\r\nexport function getCookie(key) {\r\n    let value = null\r\n    const arrCookie = document.cookie.split(\"; \")\r\n    arrCookie.forEach(item => {\r\n        const cookie = item.split('=')\r\n        if (key === cookie[0]) {\r\n            value = cookie[1]\r\n            return null\r\n        }\r\n    })\r\n    return value\r\n}","import { render } from \"./ShareValidation.vue?vue&type=template&id=ffde5580&scoped=true\"\nimport script from \"./ShareValidation.vue?vue&type=script&lang=js\"\nexport * from \"./ShareValidation.vue?vue&type=script&lang=js\"\n\nimport \"./ShareValidation.vue?vue&type=style&index=0&id=ffde5580&lang=css\"\nimport \"./ShareValidation.vue?vue&type=style&index=1&id=ffde5580&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-ffde5580\"\n\nexport default script","<template>\r\n  <div class=\"share-no-exists\">\r\n    <div class=\"img-box\">\r\n      <img src=\"https://lm-icon.oss-cn-shenzhen.aliyuncs.com/mpan/file-icon/link-invalid.png\">\r\n    </div>\r\n    <div class=\"tip\">\r\n      <div class=\"text\">\r\n        分享链接不存在或已过期\r\n      </div>\r\n      <div>\r\n        <div class=\"action\" @click=\"$router.back()\">回到上一页</div>\r\n        <div class=\"action\" @click=\"$router.push('/')\">回到首页</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"ShareNoExists\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.share-no-exists .action:hover {\r\n  color: #268bc4;\r\n}\r\n\r\n.share-no-exists .action {\r\n  font-size: 12px;\r\n  color: #35b3ff;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  margin-bottom: 4px;\r\n  transition: all .2s;\r\n  width: fit-content;\r\n}\r\n\r\n.share-no-exists .tip {\r\n  margin-top: 34px;\r\n}\r\n\r\n.share-no-exists .text {\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  color: #5c5c5c;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.share-no-exists .img-box {\r\n  height: 178px;\r\n  width: 178px;\r\n  margin-right: 26px;\r\n}\r\n\r\n.share-no-exists img {\r\n  width: 100%;\r\n}\r\n\r\n.share-no-exists {\r\n  display: flex;\r\n  height: 100%;\r\n  justify-content: center;\r\n  padding-top: 160px;\r\n}\r\n</style>","import { render } from \"./ShareNoExists.vue?vue&type=template&id=4c7dd3a4&scoped=true\"\nimport script from \"./ShareNoExists.vue?vue&type=script&lang=js\"\nexport * from \"./ShareNoExists.vue?vue&type=script&lang=js\"\n\nimport \"./ShareNoExists.vue?vue&type=style&index=0&id=4c7dd3a4&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-4c7dd3a4\"\n\nexport default script","<template>\r\n  <div class=\"share-content-home\">\r\n    <div class=\"main\">\r\n      <share-content-header :shareInfo=\"shareInfo\" @save=\"openSaveModal\" @download=\"getDownloadUrl\"/>\r\n      <file-list-main :root-path=\"$route.path\" title=\"全部文件\" :file-length=\"fileList.length\"/>\r\n      <loading-mask v-if=\"isLoading\"/>\r\n      <file-list-empty :has-upload=\"false\" v-else-if=\"fileList.length===0\"/>\r\n      <file-list-table v-else :file-list=\"fileList\" v-model:selectList=\"selectList\"/>\r\n      <modal title=\"保存到\" ref=\"saveModal\">\r\n        <template #body>\r\n          <dir-list ref=\"saveDirList\" empty-text=\"保存到此文件夹\"/>\r\n        </template>\r\n        <template #footer>\r\n          <m-button type=\"secondary\" @click=\"$refs.saveModal.close()\">取消</m-button>\r\n          <m-button @click=\"save\">保存到此</m-button>\r\n        </template>\r\n      </modal>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ShareContentHeader from \"@/views/shareContent/childComps/ShareContentHeader\";\r\nimport FileListMain from \"@/components/fileList/FileListMain\";\r\nimport FileListTable from \"@/components/fileList/fileListTable/FileListTable\";\r\nimport {getShareFileDownloadUrl, getShareFileList, saveShareFile} from \"@/api/share\";\r\nimport LoadingMask from \"@/components/loadingMask/LoadingMask\";\r\nimport Modal from \"@/components/modal/Modal\";\r\nimport DirList from \"@/components/fileList/fileListToolbar/DirList\";\r\nimport MButton from \"@/components/common/MButton\";\r\nimport FileListEmpty from \"@/components/fileList/FileListEmpty\";\r\n\r\nexport default {\r\n  name: \"ShareContentHome\",\r\n  components: {FileListEmpty, MButton, DirList, Modal, LoadingMask, FileListTable, FileListMain, ShareContentHeader},\r\n  props: {\r\n    shareInfo: Object\r\n  },\r\n  data() {\r\n    return {\r\n      fileList: [],\r\n      selectList: [],\r\n      isLoading: true\r\n    }\r\n  },\r\n  methods: {\r\n    loadFileList() {\r\n      this.isLoading = true\r\n      this.fileList = []\r\n      this.selectList = []\r\n      getShareFileList(this.$route.query.path || '/').then(res => {\r\n        this.fileList = res.data\r\n        this.isLoading = false\r\n      })\r\n    },\r\n    save() {\r\n      this.$refs.saveModal.close()\r\n      this.$message.loading('文件保存中', 'save')\r\n      saveShareFile(this.selectList, this.$refs.saveDirList.path)\r\n          .then(() => {\r\n            this.$message.success('文件保存成功', 1500, 'save')\r\n          })\r\n          .catch(res => {\r\n            this.$message.error(res.msg, 1500, 'save')\r\n          })\r\n    },\r\n    openSaveModal() {\r\n      if (this.selectList.length === 0) {\r\n        this.$message.info('请先选择文件')\r\n        return\r\n      }\r\n      const token = localStorage.getItem('authorization')\r\n      if (!token) {\r\n        this.$modal.confirm({\r\n          title: '提示',\r\n          content: '未登录，请先登录',\r\n          icon: 'info',\r\n          okText: '去登陆',\r\n          closeIcon: true,\r\n          lossFocusClose: true,\r\n          onOk() {\r\n            location.href = '/auth'\r\n          }\r\n        })\r\n        return\r\n      }\r\n      this.$refs.saveModal.open()\r\n    },\r\n    getDownloadUrl() {\r\n      if (this.selectList.length === 0) {\r\n        this.$message.info('请先选择文件')\r\n        return\r\n      }\r\n      for (let s of this.selectList) {\r\n        const item = this.fileList.find(f => {\r\n          return f.id === s\r\n        })\r\n        if (item.isDir === 1) {\r\n          this.$message.warning('暂不支持文件夹下载')\r\n          return\r\n        }\r\n      }\r\n      if (this.selectList.length > 10) {\r\n        this.$message.info('一次下载请求最多包含10个文件')\r\n        return\r\n      }\r\n      getShareFileDownloadUrl(this.selectList)\r\n          .then(res => {\r\n            res.data.forEach(item => {\r\n              this.download(item)\r\n            })\r\n          })\r\n          .catch(res => {\r\n            this.$message.error(res.msg)\r\n          })\r\n    },\r\n    download(url) {\r\n      const frame = document.createElement('iframe')\r\n      frame.setAttribute('style', 'display: none')\r\n      frame.setAttribute('src', url)\r\n      document.body.appendChild(frame)\r\n      setTimeout(() => {\r\n        frame.remove()\r\n      }, 1000)\r\n    },\r\n  },\r\n  watch: {\r\n    '$route': {\r\n      handler() {\r\n        if (!this.$route.path.startsWith('/s/')) {\r\n          return\r\n        }\r\n        this.loadFileList()\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.loadFileList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.share-content-home .main {\r\n  width: calc(100% - 20px);\r\n  height: calc(100% - 34px);\r\n  margin: 10px 30px;\r\n  background-color: #fff;\r\n  border-radius: 6px;\r\n}\r\n\r\n.share-content-home {\r\n  background-color: #f7f7f7;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.main {\r\n  padding-top: 20px;\r\n  padding-left: 10px;\r\n  padding-right: 18px;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.file-list-table {\r\n  margin-left: -4px;\r\n  margin-right: -14px;\r\n  height: calc(100% - 116px);\r\n}\r\n</style>","<template>\r\n  <div class=\"share-content-header\">\r\n    <div class=\"share-info\">\r\n      <div class=\"main\">\r\n        <div class=\"name-info\">\r\n          <img :src=\"shareIcon\">\r\n          <div class=\"name-text\">{{ shareInfo.name }}</div>\r\n        </div>\r\n        <div class=\"action\">\r\n          <m-button icon=\"wenjian_zhuancun\" type=\"secondary\" @click=\"saveClick\">保存到网盘</m-button>\r\n          <m-button icon=\"download\" type=\"secondary\" @click=\"downloadClick\">下载</m-button>\r\n        </div>\r\n      </div>\r\n      <div class=\"other-info\">\r\n        <div class=\"item\">\r\n          <span>\r\n            <svg class=\"icon\" aria-hidden=\"true\">\r\n              <use xlink:href=\"#icon-shizhong\"></use>\r\n            </svg>\r\n          </span>\r\n          {{ createTime }}\r\n        </div>\r\n        <div class=\"item\">\r\n          <span>过期时间：</span>\r\n          <span v-if=\"!shareInfo.expiryTime\">永久有效</span>\r\n          <span v-else-if=\"expiryTime\">{{ expiryTime }}后</span>\r\n          <span class=\"expiring-soon\" v-else>即将失效</span>\r\n        </div>\r\n        <div class=\"user-info item\">\r\n          <img :src=\"userAvatar\">\r\n          <div class=\"info-text\">{{ shareInfo.userName }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getAvatar, iconType} from \"@/utils/FileIcon\";\r\nimport MButton from \"@/components/common/MButton\";\r\nimport {differenceTime, standardTime} from \"@/utils/TimeFormat\";\r\n\r\nexport default {\r\n  name: \"ShareContentHeader\",\r\n  components: {MButton},\r\n  props: {\r\n    shareInfo: Object\r\n  },\r\n  methods: {\r\n    saveClick() {\r\n      this.$emit('save')\r\n    },\r\n    downloadClick() {\r\n      this.$emit('download')\r\n    }\r\n  },\r\n  computed: {\r\n    shareIcon() {\r\n      return iconType.shareIcon\r\n    },\r\n    userAvatar() {\r\n      if (this.shareInfo.userAvatar) {\r\n        return getAvatar(this.shareInfo.userAvatar)\r\n      } else {\r\n        return iconType.defaultAvatar;\r\n      }\r\n    },\r\n    createTime() {\r\n      return standardTime(this.shareInfo.createTime)\r\n    },\r\n    expiryTime() {\r\n      return differenceTime(this.shareInfo.expiryTime)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.action .m-button {\r\n  margin-left: 14px;\r\n}\r\n\r\n.action {\r\n  margin-left: auto;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.user-info img {\r\n  border-radius: 50%;\r\n  height: 22px;\r\n  width: 22px;\r\n  margin-right: 4px;\r\n}\r\n\r\n.name-text {\r\n  font-size: 14px;\r\n  color: #333;\r\n  font-weight: 700;\r\n  margin-left: 8px;\r\n}\r\n\r\n.name-info img {\r\n  height: 40px;\r\n  width: 40px;\r\n}\r\n\r\n.name-info {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.other-info .item {\r\n  margin-right: 18px;\r\n}\r\n\r\n.other-info {\r\n  display: flex;\r\n  height: 22px;\r\n  line-height: 22px;\r\n  font-size: 12px;\r\n  color: #666;\r\n  margin-left: 12px;\r\n  margin-top: 6px;\r\n}\r\n\r\n.main {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.share-info {\r\n  width: 100%;\r\n}\r\n\r\n.share-content-header {\r\n  display: flex;\r\n  padding-bottom: 8px;\r\n  align-items: center;\r\n  position: relative;\r\n}\r\n\r\n.share-content-header:after {\r\n  content: \" \";\r\n  position: absolute;\r\n  right: 0;\r\n  left: 0;\r\n  height: 1px;\r\n  bottom: -6px;\r\n  background-color: #f9f9f9;\r\n}\r\n</style>","import { render } from \"./ShareContentHeader.vue?vue&type=template&id=249c66d9&scoped=true\"\nimport script from \"./ShareContentHeader.vue?vue&type=script&lang=js\"\nexport * from \"./ShareContentHeader.vue?vue&type=script&lang=js\"\n\nimport \"./ShareContentHeader.vue?vue&type=style&index=0&id=249c66d9&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-249c66d9\"\n\nexport default script","import { render } from \"./ShareContentHome.vue?vue&type=template&id=d537f51a&scoped=true\"\nimport script from \"./ShareContentHome.vue?vue&type=script&lang=js\"\nexport * from \"./ShareContentHome.vue?vue&type=script&lang=js\"\n\nimport \"./ShareContentHome.vue?vue&type=style&index=0&id=d537f51a&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-d537f51a\"\n\nexport default script","import { render } from \"./ShareContent.vue?vue&type=template&id=49141905&scoped=true\"\nimport script from \"./ShareContent.vue?vue&type=script&lang=js\"\nexport * from \"./ShareContent.vue?vue&type=script&lang=js\"\n\nimport \"./ShareContent.vue?vue&type=style&index=0&id=49141905&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-49141905\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareValidation.vue?vue&type=style&index=1&id=ffde5580&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareValidation.vue?vue&type=style&index=0&id=ffde5580&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareContent.vue?vue&type=style&index=0&id=49141905&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareContentHome.vue?vue&type=style&index=0&id=d537f51a&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareNoExists.vue?vue&type=style&index=0&id=4c7dd3a4&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShareContentHeader.vue?vue&type=style&index=0&id=249c66d9&scoped=true&lang=css\""],"sourceRoot":""}